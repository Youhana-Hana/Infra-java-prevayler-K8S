#!/bin/bash
set -e

# deploy app deployment and service
kubectl create -f deployment/web-app.yml

# deploy app deployment and service
kubectl create -f deployment/web-static.yml

# smoke test to list all pods, deployments and services
kubectl get pod,deploy,svc

echo -e 'Sleeping 10 seconds'
sleep 10s

echo -e "Copy the given loadbalancer URL into the browser\n"
kubectl get svc/company-news-service --template="{{range .status.loadBalancer.ingress}} {{.hostname}} {{end}}"
echo -e "\n"
kubectl get svc/company-news-static-service --template="{{range .status.loadBalancer.ingress}} {{.hostname}} {{end}}"
